# –ü—Ä–æ–±–ª–µ–º–∞: eBay UserID = None

**–î–∞—Ç–∞:** 2025-01-XX  
**–ü—Ä–æ–±–ª–µ–º–∞:** Identity API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None` –¥–ª—è username –∏ userId

---

## üîç –°–∏–º–ø—Ç–æ–º—ã

–í–æ –≤—Å–µ—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è—Ö –≤–∏–¥–∏–º:
```
Connected as: None (eBay UserID: None)
```

---

## üîß –ß—Ç–æ –º—ã –¥–µ–ª–∞–µ–º

### –¢–µ–∫—É—â–∏–π –∫–æ–¥ Identity API:

```python
api_url = f"{settings.ebay_api_base_url}/identity/v1/oauth2/userinfo"
headers = {
    "Authorization": f"Bearer {access_token}",
    "Accept": "application/json"
}
response = await client.get(api_url, headers=headers)
```

### Endpoint:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ `/identity/v1/oauth2/userinfo` (–±—ã–ª–æ `/identity/v1/user`)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞:
- –ü—Ä–æ–≤–µ—Ä—è–µ–º `response.status_code != 200` ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None
- –ü–∞—Ä—Å–∏–º JSON ‚Üí –∏–∑–≤–ª–µ–∫–∞–µ–º `username` –∏ `user_id`/`userId`
- –ï—Å–ª–∏ exception ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None

---

## ‚ùì –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. Identity API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ 200
- **–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ `Identity API error XXX`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ù—É–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ backend –Ω–∞ Railway

### 2. Identity API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200, –Ω–æ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö
- **–°–∏–º–ø—Ç–æ–º:** JSON –ø—É—Å—Ç–æ–π –∏–ª–∏ –±–µ–∑ –ø–æ–ª–µ–π `username`/`user_id`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ raw response

### 3. –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –Ω—É–∂–Ω–æ–≥–æ scope
- **–°–∏–º–ø—Ç–æ–º:** Identity API –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 401/403 –∏–ª–∏ –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å scope —Ç–æ–∫–µ–Ω–∞

### 4. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
- **–°–∏–º–ø—Ç–æ–º:** JSON –ø–∞—Ä—Å–∏—Ç—Å—è, –Ω–æ –ø–æ–ª—è –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ parsed JSON

### 5. Exception –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ
- **–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞ `Error getting user identity`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –î–æ–±–∞–≤–ª–µ–Ω–æ `exc_info=True` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ traceback

---

## üîß –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
   - Response status code
   - Response headers
   - Raw response (–ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤)
   - Parsed JSON
   - –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è username –∏ userId

2. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ JSON parsing errors
   - –ü–æ–ª–Ω—ã–π traceback –ø—Ä–∏ exception

---

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è** - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend –Ω–∞ Railway
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** - –Ω–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–∏ —Å "Identity API" –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω** - —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω –∏ –∏–º–µ–µ—Ç –Ω—É–∂–Ω—ã–π scope
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** - —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ endpoint –∏ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ

---

## üí° –í–æ–ø—Ä–æ—Å—ã –¥–ª—è "—É–º–Ω–æ–≥–æ –¥—Ä—É–≥–∞"

1. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ endpoint `/identity/v1/oauth2/userinfo`?
2. –ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å Identity API?
3. –ö–∞–∫–∏–µ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ—Ç–≤–µ—Ç–µ (username, user_id, userId)?
4. –ù—É–∂–µ–Ω –ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π scope –¥–ª—è Identity API?
5. –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏?

